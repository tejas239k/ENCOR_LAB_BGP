ENCOR_LAB_BGP

R1
enable
configure terminal
hostname R1
interface e0/0
ip address 10.1.12.1 255.255.255.0
no shutdown
exit
interface e0/1
ip address 10.1.13.1 255.255.255.0
no shutdown
exit
interface e0/2
ip address 10.1.14.1 255.255.255.0
no shutdown
exit
interface e0/3
ip address 10.1.16.1 255.255.255.0
no shutdown
exit
interface loopback 0
ip address 1.1.1.1 255.0.0.0
exit
interface loopback 1
ip address 11.11.11.11 255.0.0.0
exit
interface loopback 2
ip address 10.1.1.1 255.255.255.0
exit

R2
enable
configure terminal
hostname R2
interface e0/0
ip address 10.1.12.2 255.255.255.0
no shutdown
exit
interface e0/1
ip address 10.1.23.2 255.255.255.0
no shutdown
exit
interface e0/2
ip address 10.1.25.2 255.255.255.0
no shutdown
exit
interface loopback 0
ip address 2.2.2.2 255.0.0.0
exit
interface loopback 1
ip address 22.22.22.22 255.0.0.0
exit
interface loopback 2
ip address 10.2.2.2 255.255.255.0
exit

R3
enable
configure terminal
hostname R3
interface e0/0
ip address 10.1.23.3 255.255.255.0
no shutdown
exit
interface e0/1
ip address 10.1.13.3 255.255.255.0
no shutdown
exit
interface e0/3
ip address 10.1.36.3 255.255.255.0
no shutdown
exit
interface loopback 0
ip address 3.3.3.3 255.0.0.0
exit
interface loopback 1
ip address 33.33.33.33 255.0.0.0
exit
interface loopback 2
ip address 10.3.3.3 255.255.255.0
exit

R4
enable
configure terminal
hostname R4
interface e0/0
ip address 10.1.14.4 255.255.255.0
no shutdown
exit
interface e0/1
ip address 10.1.46.4 255.255.255.0
no shutdown
exit
interface loopback 0
ip address 4.4.4.4 255.0.0.0
exit
interface loopback 1
ip address 44.44.44.44 255.0.0.0
exit
interface loopback 2
ip address 10.4.4.4 255.255.255.0
exit

R5
enable
configure terminal
hostname R5
interface e0/0
ip address 10.1.25.5 255.255.255.0
no shutdown
exit
interface loopback 0
ip address 5.5.5.5 255.0.0.0
exit
interface loopback 1
ip address 55.55.55.55 255.0.0.0
exit
interface loopback 2
ip address 10.5.5.5 255.255.255.0
exit


R6
enable
configure terminal
hostname R6
interface e0/0
ip address 10.1.16.6 255.255.255.0
no shutdown
exit
interface e0/1
ip address 10.1.46.6 255.255.255.0
no shutdown
exit
interface e0/3
ip address 10.1.36.6 255.255.255.0
no shutdown
exit
interface loopback 0
ip address 6.6.6.6 255.0.0.0
exit
interface loopback 1
ip address 66.66.66.66 255.255.255.0
exit
interface loopback 2
ip address 10.6.6.6 255.255.255.0
exit
interface loopback 11
ip address 66.66.67.66 255.255.255.0
exit
interface loopback 12
ip address 66.66.68.66 255.255.255.0
exit
interface loopback 13
ip address 66.66.69.66 255.255.255.0
exit
interface loopback 14
ip address 66.66.70.66 255.255.255.0
exit
____________________________________________________________________

----------------------------------
eBGP Neighborship between R1 and R4
----------------------------------
R1
router bgp 10
bgp router-id 1.1.1.1 
neighbor 10.1.14.4 remote-as 40
network 1.0.0.0 mask 255.0.0.0
network 11.0.0.0 mask 255.0.0.0
exit

R4
router bgp 40
bgp router-id 4.4.4.4 
neighbor 10.1.14.1 remote-as 10
network 4.0.0.0 mask 255.0.0.0
network 44.0.0.0 mask 255.0.0.0
exit

----------------------------------
eBGP Neighborship between R1 and R6
----------------------------------

R1
router bgp 10
neighbor 10.1.16.6 remote-as 70
exit

R6

access-list 1 permit 66.66.0.0 0.0.255.255
!
route-map REDISTRIBUTE
match ip address 1
!
router bgp 70
bgp router-id 6.6.6.6
neighbor 10.1.16.1 remote-as 10
network 6.0.0.0 mask 255.0.0.0
redistribute connected route-map REDISTRIBUTE 
exit


----------------------------------
eBGP Neighborship between R4 and R6
----------------------------------
R4
router bgp 40
neighbor 10.1.46.6 remote-as 70
exit

R6
router bgp 70
neighbor 10.1.46.4 remote-as 40
exit


----------------------------------
eBGP Neighborship between R2 and R5
----------------------------------
R2
router bgp 10
neighbor 10.1.25.5 remote-as 50
neighbor 10.1.25.5 password cisco123
network 2.0.0.0 mask 255.0.0.0
network 22.0.0.0 mask 255.0.0.0
exit


R5
router bgp 50
neighbor 10.1.25.2 remote-as 10
neighbor 10.1.25.2 password cisco123
network 5.0.0.0 mask 255.0.0.0
network 55.0.0.0 mask 255.0.0.0
exit


----------------------------------
eBGP Neighborship between R3 and R6
----------------------------------
R3
router bgp 10
neighbor 10.1.36.6 remote-as 70
network 3.0.0.0 mask 255.0.0.0
network 33.0.0.0 mask 255.0.0.0
exit


R6
router bgp 70
neighbor 10.1.36.3 remote-as 10
exit


----------------------------------
Configure IGP(EIGRP) within AS 10
----------------------------------

R1
router eigrp 1
network 10.1.12.0 0.0.0.255
network 10.1.13.0 0.0.0.255
network 10.1.1.0 0.0.0.255
exit


R2
router eigrp 1
network 10.1.12.0 0.0.0.255
network 10.1.23.0 0.0.0.255
network 10.2.2.0 0.0.0.255
exit

R3
router eigrp 1
network 10.1.13.0 0.0.0.255
network 10.1.23.0 0.0.0.255
network 10.3.3.0 0.0.0.255
exit


----------------------------------
Configure iBGP between R1 and R2
----------------------------------

R1
router bgp 10
neighbor 10.2.2.2 remote-as 10
neighbor 10.2.2.2 update-source loopback 2
exit

R2
router bgp 10
neighbor 10.1.1.1 remote-as 10
neighbor 10.1.1.1 update-source loopback 2
exit

----------------------------------
Configure iBGP between R2 and R3
----------------------------------

R2
router bgp 10
neighbor 10.3.3.3 remote-as 10
neighbor 10.3.3.3 update-source loopback 2
exit

R3
router bgp 10
neighbor 10.2.2.2 remote-as 10
neighbor 10.2.2.2 update-source loopback 2
exit

-----------------------
Next-hop-self Attribute
-----------------------

R1
router bgp 10
neighbor 10.2.2.2 next-hop-self
exit

R2
router bgp 10
neighbor 10.1.1.1 next-hop-self
neighbor 10.3.3.3 next-hop-self
exit

R3
router bgp 10
neighbor 10.2.2.2 next-hop-self
exit


-------------------------------
Configure R2 as Route-reflector
-------------------------------

R2

router bgp 10
neighbor 10.1.1.1 route-reflector-client
neighbor 10.3.3.3 route-reflector-client
exit